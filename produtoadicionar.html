<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adicionar Carro</title>
    <style>
    body {
    font-family: Arial, sans-serif;
    background-color: transparent !important;
    color: #f0f4ff; /* Cor clara para contraste com o fundo */
    padding: 20px;
    margin: 0;
}

.form-container {
    background-color: #012063; /* Fundo da sua brand */
    padding: 20px;
    padding-left: 50px;
    padding-right: 50px;
    border-radius: 8px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); /* Sombra mais intensa para destacar */
    max-width: 500px; /* Largura fixa mais compacta */
    margin: 0 auto;
    color: #f0f4ff; /* Texto claro para boa leitura */
    box-sizing: border-box; /* Inclui padding no cálculo do tamanho */
}

.form-container h2 {
    text-align: center;
    margin-bottom: 20px;
    color: #ffffff; /* Cor branca para o título */
    font-size: 1.5rem; /* Tamanho proporcional ao container */
}

label {
    display: block;
    margin: 10px 0 5px;
    color: #dce6ff; /* Cor suave e legível para os rótulos */
    font-size: 0.9rem; /* Tamanho ajustado */
}

input, textarea {
    width: calc(100% - 16px); /* Garante que o campo se ajuste bem ao container */
    padding: 10px;
    margin-bottom: 10px;
    border-radius: 4px;
    border: 1px solid #85a9ff; /* Bordas em azul claro */
    background-color: #f0f4ff; /* Fundo claro para contraste */
    color: #012063; /* Texto escuro para leitura */
    font-size: 0.95rem;
    box-sizing: border-box; /* Evita overflow nos campos */
}

input:focus, textarea:focus {
    outline: none;
    border: 1px solid #4b8cff; /* Realce ao focar no campo */
    box-shadow: 0 0 4px #4b8cff;
}

textarea {
    resize: none; /* Impede o redimensionamento que pode quebrar o layout */
    height: 120px; /* Altura fixa */
}

button {
    background-color: #4b8cff; /* Botão em azul vibrante */
    color: #ffffff; /* Texto branco no botão */
    padding: 10px 15px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    width: 100%;
    font-size: 1rem;
    font-weight: bold;
}

button:hover {
    background-color: #3a6dd8; /* Sombra de azul ao passar o mouse */
}

@media (max-width: 600px) {
    .form-container {
        padding: 15px; /* Reduz padding para telas menores */
    }
    input, textarea {
        font-size: 0.9rem; /* Ajusta texto dos campos em telas menores */
    }
    button {
        font-size: 0.95rem; /* Ajusta tamanho do botão */
    }
}

    </style>
</head>
<body>

<div class="form-container">
    <h2>Adicionar Carro</h2>
    <form id="carForm">
        <label for="model">Modelo</label>
        <input type="text" id="model" name="model" required>

        <label for="description">Descrição</label>
        <textarea id="description" name="description" required></textarea>

        <label for="mileage">Quilometragem</label>
        <input type="number" id="mileage" name="mileage" required>

        <label for="condition">Condição (em %)</label>
        <input type="number" id="condition" name="condition" required>

        <label for="fuel">Combustível (em %)</label>
        <input type="number" id="fuel" name="fuel" required>

  <!-- Barra 1 -->
        <label for="image1">Imagem 1 (selecione arquivo)</label>
        <input type="file" id="image1" name="images[]" accept="image/*" required>

        <!-- Barra 2 -->
        <label for="image2">Imagem 2 (selecione arquivo)</label>
        <input type="file" id="image2" name="images[]" accept="image/*">

        <!-- Barra 3 -->
        <label for="image3">Imagem 3 (selecione arquivo)</label>
        <input type="file" id="image3" name="images[]" accept="image/*">

        <!-- Barra 4 -->
        <label for="image4">Imagem 4 (selecione arquivo)</label>
        <input type="file" id="image4" name="images[]" accept="image/*">
        
        <button type="submit">Adicionar Carro</button>
        <div id="notification-container" style="margin-top: 20px; color: white; font-weight: bold;"></div>

    </form>
</div>

<div id="notification-container" style="margin-top: 20px; color: white; font-weight: bold;"></div>
 

<script>
    document.getElementById("carForm").addEventListener("submit", async function (event) {
        event.preventDefault();

        // Função para fazer upload de uma única imagem
        async function uploadImage(file, uniqueName) {
            const s3Url = `https://car-inventory-storage-xyz.s3.eu-north-1.amazonaws.com/${uniqueName}`;
            try {
                const response = await fetch(s3Url, {
                    method: "PUT",
                    headers: {
                        "Content-Type": file.type, // Tipo do arquivo
                    },
                    body: file, // Envia o arquivo diretamente
                });

                if (response.ok) {
                    console.log(`Imagem carregada com sucesso: ${s3Url}`);
                    return s3Url; // Retorna a URL pública da imagem
                } else {
                    throw new Error(`Erro ao carregar a imagem: ${response.statusText}`);
                }
            } catch (error) {
                console.error("Erro no upload da imagem:", error);
                throw error;
            }
        }

        // Captura as imagens dos campos de upload
        const imageFiles = [
            document.getElementById("image1").files[0],
            document.getElementById("image2").files[0],
            document.getElementById("image3").files[0],
            document.getElementById("image4").files[0],
        ];

        const uploadedImageUrls = [];

        try {
            for (let i = 0; i < imageFiles.length; i++) {
                if (imageFiles[i]) {
                    const uniqueName = `image_${Date.now()}_${i}.jpg`; // Nome único
                    const uploadedUrl = await uploadImage(imageFiles[i], uniqueName);
                    uploadedImageUrls.push(uploadedUrl);
                }
            }

            // Agora todas as imagens foram carregadas com sucesso
            console.log("URLs das imagens carregadas:", uploadedImageUrls);

            // Captura os outros campos do formulário
            const model = document.getElementById("model").value;
            const description = document.getElementById("description").value;
            const mileage = document.getElementById("mileage").value;
            const condition = document.getElementById("condition").value;
            const fuel = document.getElementById("fuel").value;

            // Objeto para salvar no JSON
            const newCar = {
                model: model,
                description: description,
                mileage: parseInt(mileage),
                condition: parseInt(condition),
                fuel: parseInt(fuel),
                images: uploadedImageUrls, // URLs das imagens carregadas
            };

            console.log("Novo carro adicionado:", newCar);

            // Aqui você pode enviar `newCar` para salvar no JSON do S3
        } catch (error) {
            console.error("Erro ao processar o formulário:", error);
            alert("Erro ao carregar as imagens. Tente novamente.");
        }
    });
</script>





</body>
</html>
